--- src/3rd_party/libsrp6a-sha512/t_math.c.orig
+++ src/3rd_party/libsrp6a-sha512/t_math.c
@@ -720,7 +720,7 @@
   else if(a == NULL) {
     BN_mod_exp(r, b, e, m, c);
   }
-#if OPENSSL_VERSION_NUMBER >= 0x00906000
+#if OPENSSL_VERSION_NUMBER >= 0x00906000 && !defined(LIBRESSL_VERSION_NUMBER)
   else if(B > 0 && B < ULONG_MAX) {  /* 0.9.6 and above has mont_word optimization */
     BN_mod_exp_mont_word(r, B, e, m, c, a);
   }
--- src/common/userpref.c.orig
+++ src/common/userpref.c
@@ -627,7 +627,6 @@
 		}
 	}
 
-	X509V3_EXT_cleanup();
 	X509_free(dev_cert);
 
 	EVP_PKEY_free(pubkey);
