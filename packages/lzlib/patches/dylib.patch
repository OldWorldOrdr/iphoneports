--- source/Makefile.in.orig
+++ source/Makefile.in
@@ -25,14 +25,15 @@
 lib$(libname).a : lzlib.o
 	$(AR) $(ARFLAGS) $@ $<
 
-lib$(libname).so.$(pkgversion) : lzlib_sh.o
-	$(CC) $(CFLAGS) $(LDFLAGS) -fpic -fPIC -shared -Wl,--soname=lib$(libname).so.$(soversion) -o $@ $<
+lib$(libname).$(pkgversion).dylib : lzlib_sh.o
+	$(CC) $(CFLAGS) $(LDFLAGS) -fpic -fPIC -dynamiclib -Wl,-install_name,lib$(libname).$(pkgversion).dylib -o $@ $<
+	$(INSTALLNAMETOOL) -id $(libdir)/lib$(libname).$(pkgversion).dylib $@
 
 $(progname) : $(objs) lib$(libname).a
 	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $(objs) lib$(libname).a
 
-$(progname)_shared : $(objs) lib$(libname).so.$(pkgversion)
-	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $(objs) lib$(libname).so.$(pkgversion)
+$(progname)_shared : $(objs) lib$(libname).$(pkgversion).dylib
+	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $(objs) lib$(libname).$(pkgversion).dylib
 
 bbexample : bbexample.o lib$(libname).a
 	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ bbexample.o lib$(libname).a
@@ -105,15 +106,15 @@
 	  $(INSTALL_DATA) ./lib$(libname).a "$(DESTDIR)$(libdir)/lib$(libname).a" ; \
 	fi
 	if [ -n "$(progname_shared)" ] ; then \
-	  $(INSTALL_PROGRAM) ./lib$(libname).so.$(pkgversion) "$(DESTDIR)$(libdir)/lib$(libname).so.$(pkgversion)" ; \
-	  if [ -e "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)" ] ; then \
+	  $(INSTALL_PROGRAM) ./lib$(libname).$(pkgversion).dylib "$(DESTDIR)$(libdir)/lib$(libname).$(pkgversion).dylib" ; \
+	  if [ -e "$(DESTDIR)$(libdir)/lib$(libname).$(soversion).dylib" ] ; then \
 	    run_ldconfig=no ; \
 	  else run_ldconfig=yes ; \
 	  fi ; \
-	  rm -f "$(DESTDIR)$(libdir)/lib$(libname).so" ; \
-	  rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)" ; \
-	  cd "$(DESTDIR)$(libdir)" && ln -s lib$(libname).so.$(pkgversion) lib$(libname).so ; \
-	  cd "$(DESTDIR)$(libdir)" && ln -s lib$(libname).so.$(pkgversion) lib$(libname).so.$(soversion) ; \
+	  rm -f "$(DESTDIR)$(libdir)/lib$(libname).dylib" ; \
+	  rm -f "$(DESTDIR)$(libdir)/lib$(libname).$(soversion).dylib" ; \
+	  cd "$(DESTDIR)$(libdir)" && ln -s lib$(libname).$(pkgversion).dylib lib$(libname).dylib ; \
+	  cd "$(DESTDIR)$(libdir)" && ln -s lib$(libname).$(pkgversion).dylib lib$(libname).$(soversion).dylib ; \
 	  if [ "${disable_ldconfig}" != yes ] && [ $${run_ldconfig} = yes ] && \
 	     [ -x "$(LDCONFIG)" ] ; then "$(LDCONFIG)" -n "$(DESTDIR)$(libdir)" || true ; fi ; \
 	fi
@@ -152,9 +153,9 @@
 uninstall-lib :
 	-rm -f "$(DESTDIR)$(includedir)/$(libname)lib.h"
 	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).a"
-	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so"
-	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(soversion)"
-	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).so.$(pkgversion)"
+	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).dylib"
+	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).$(soversion).dylib"
+	-rm -f "$(DESTDIR)$(libdir)/lib$(libname).$(pkgversion).dylib"
 
 uninstall-info :
 	-if $(CAN_RUN_INSTALLINFO) ; then \
@@ -195,7 +196,7 @@
 
 clean :
 	-rm -f $(progname) $(objs) lzlib.o lib$(libname).a
-	-rm -f $(progname)_shared lzlib_sh.o lib$(libname).so*
+	-rm -f $(progname)_shared lzlib_sh.o *.dylib
 	-rm -f bbexample bbexample.o ffexample ffexample.o lzcheck lzcheck.o
 
 distclean : clean
--- source/configure.orig
+++ source/configure
@@ -82,6 +82,7 @@
 		echo "  --disable-ldconfig    don't run ldconfig after install"
 		echo "  CC=COMPILER           C compiler to use [${CC}]"
 		echo "  AR=ARCHIVER           library archiver to use [${AR}]"
+		echo "  INSTALLNAMETOOL=TOOL  tool to set the install name of a shared library"
 		echo "  CPPFLAGS=OPTIONS      command line options for the preprocessor [${CPPFLAGS}]"
 		echo "  CFLAGS=OPTIONS        command line options for the C compiler [${CFLAGS}]"
 		echo "  CFLAGS+=OPTIONS       append options to the current value of CFLAGS"
@@ -123,6 +124,7 @@
 
 	CC=*)              CC=${optarg} ;;
 	AR=*)              AR=${optarg} ;;
+	INSTALLNAMETOOL=*) INSTALLNAMETOOL=${optarg} ;;
 	CPPFLAGS=*)  CPPFLAGS=${optarg} ;;
 	CFLAGS=*)      CFLAGS=${optarg} ;;
 	CFLAGS+=*)     CFLAGS="${CFLAGS} ${optarg}" ;;
@@ -196,6 +198,7 @@
 echo "mandir = ${mandir}"
 echo "CC = ${CC}"
 echo "AR = ${AR}"
+echo "INSTALLNAMETOOL = ${INSTALLNAMETOOL}"
 echo "CPPFLAGS = ${CPPFLAGS}"
 echo "CFLAGS = ${CFLAGS}"
 echo "LDFLAGS = ${LDFLAGS}"
@@ -229,6 +232,7 @@
 mandir = ${mandir}
 CC = ${CC}
 AR = ${AR}
+INSTALLNAMETOOL = ${INSTALLNAMETOOL}
 CPPFLAGS = ${CPPFLAGS}
 CFLAGS = ${CFLAGS}
 LDFLAGS = ${LDFLAGS}
